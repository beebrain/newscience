# Git Secrets Patterns
# รูปแบบที่ต้องการตรวจสอบเพื่อป้องกันการ commit secrets

# ============================================
# API Keys & Access Tokens
# ============================================

# AWS Access Keys
(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}
aws_access_key_id\s*=\s*["'][A-Z0-9]{20}["']
aws_secret_access_key\s*=\s*["'][A-Za-z0-9/+=]{40}["']

# GitHub Tokens
ghp_[a-zA-Z0-9]{36}
github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59}
gho_[a-zA-Z0-9]{36}
ghu_[a-zA-Z0-9]{36}
ghs_[a-zA-Z0-9]{36}
ghr_[a-zA-Z0-9]{36}

# GitLab Tokens
glpat-[a-zA-Z0-9\-]{20}

# Generic API Keys (Base64 encoded 40 chars)
[A-Za-z0-9/+=]{40}

# JWT Tokens
eyJ[a-zA-Z0-9_-]*\.eyJ[a-zA-Z0-9_-]*\.[a-zA-Z0-9_-]*

# ============================================
# Private Keys
# ============================================
-----BEGIN (RSA |DSA |EC |OPENSSH )?PRIVATE KEY-----
-----BEGIN PRIVATE KEY-----
-----BEGIN RSA PRIVATE KEY-----
-----BEGIN DSA PRIVATE KEY-----
-----BEGIN EC PRIVATE KEY-----
-----BEGIN OPENSSH PRIVATE KEY-----

# ============================================
# Database Connection Strings
# ============================================
(mongodb(\+srv)?|mysql|postgresql|postgres|redis|mysql2)://[^\s\"]+:[^\s\"]+@[^\s\"]+
jdbc:(mysql|postgresql|sqlserver|oracle)://[^\s\"]+:[^\s\"]+@[^\s\"]+

# ============================================
# Credentials & Passwords
# ============================================

# Generic password patterns
(password|passwd|pwd|secret|token|key|api_key|apikey)\s*=\s*["'][^"']{8,}["']

# Environment variables with values
[A-Z_]+_(KEY|TOKEN|SECRET|PASSWORD|PASS|API_KEY)\s*=\s*[^\s"']{8,}

# Basic Auth in URLs
https?://[^/\s:]+:[^/\s:]+@[^/\s]+

# ============================================
# CodeIgniter Specific
# ============================================

# Database config with real passwords
'database'\s*=>\s*["'][^"']+["'](?!.*test|.*example|.*demo|.*sample)
'password'\s*=>\s*["'][^"']{4,}["'](?!.*test|.*example|.*demo|.*sample)

# ============================================
# Other Secrets
# ============================================

# SendGrid API Key
SG\.[a-zA-Z0-9_-]{22}\.[a-zA-Z0-9_-]{43}

# Slack Tokens
xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24}

# Google API Keys
AIza[0-9A-Za-z_-]{35}

# Heroku API Keys
[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}

# Facebook Access Tokens
EAACEdEose0cBA[0-9A-Za-z]+

# Twitter API Keys
[0-9a-zA-Z]{25,35}
